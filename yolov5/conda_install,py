# > python conda_reinstall.py safe_ar requirements.txt

import os
import subprocess
import sys

def create_and_install_env(env_name, requirements_file):
    # Remove the existing conda environment if it exists
    subprocess.run(["conda", "env", "remove", "--name", env_name, "-y"])

    # Create a new conda environment
    subprocess.run(["conda", "create", "--name", env_name, "python=3.8", "-y"])

    # Activate the new environment
    os.system("conda activate " + env_name)

    # Install the packages from requirements.txt
    subprocess.run(["pip", "install", "-r", requirements_file])

if __name__ == "__main__":
    env_name = sys.argv[1]
    requirements_file = sys.argv[2]
    create_and_install_env(env_name, requirements_file)